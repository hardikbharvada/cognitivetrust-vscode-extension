# rules:
#   - id: hardcoded-secret
#     patterns:
#       - pattern: $VAR = "$SECRET"
#       - metavariable-pattern:
#           metavariable: $SECRET
#           pattern: /(?i)(api[_-]?key|token|secret|passwd|password|credentials)/
#     message: "Possible hardcoded secret detected"
#     severity: ERROR
#     languages: [python]
#     metadata:
#       category: security
#       cwe: "CWE-798: Use of Hard-coded Credentials"

rules:
  - id: hardcoded-secret
    languages:
      - python
    severity: ERROR
    message: "Possible hardcoded secret detected. Avoid storing credentials in source code."
    patterns:
      - pattern: $VAR = "..."
      - metavariable-regex:
          metavariable: $VAR
          regex: (?i)key|secret|token|password|passwd|api_key|api-key